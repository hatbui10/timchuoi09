<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Pattern Builder IPFS Auto</title>

<style>
*{box-sizing:border-box;}
body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:flex-start;
  padding-top:40px;
  background:linear-gradient(135deg,#141e30,#243b55);
  font-family:Segoe UI, Arial, sans-serif;
  color:#fff;
}
.wrapper{
  width:520px;
  background:rgba(255,255,255,0.06);
  backdrop-filter:blur(14px);
  padding:35px;
  border-radius:18px;
  box-shadow:0 25px 60px rgba(0,0,0,0.45);
}
h2{text-align:center;margin-bottom:25px;font-weight:600;}
.section{margin-bottom:18px;}
label{display:block;font-size:13px;margin-bottom:6px;opacity:0.8;}
input,select{
  width:100%;padding:10px 12px;border-radius:10px;
  border:none;outline:none;font-size:16px;
  background:red;color:#fff;
}
input:focus,select:focus{
  background:#2c3e50;box-shadow:0 0 0 2px #4fc3f7;
}
.row{display:flex;gap:10px;}
button{
  width:100%;margin-top:15px;padding:12px;
  border:none;border-radius:12px;
  background:#4fc3f7;color:#000;
  font-weight:600;cursor:pointer;
}
button:hover{background:#29b6f6;}
.pattern-preview{
  margin-top:15px;font-size:13px;opacity:0.8;word-break:break-all;
}
pre{
  margin-top:20px;max-height:300px;
  overflow:auto;white-space:pre-wrap;
  background:#0f1722;padding:15px;border-radius:12px;
  font-size:13px;
}
</style>
</head>

<body>

<div class="wrapper">

<h2>Pattern Builder IPFS Auto</h2>

<div class="section">
  <label>Số đầu</label>
  <input type="number" id="firstNumber" min="0" max="9" value="7">
</div>

<div class="section">
  <label>Nhóm 1</label>
  <div class="row">
    <input type="number" id="count1" value="2" min="1">
    <select id="condition1">
      <option value="gt">> 5</option>
      <option value="gte">>= 5</option>
      <option value="lt">< 5</option>
      <option value="lte"><= 5</option>
    </select>
  </div>
</div>

<div class="section">
  <label>Nhóm 2</label>
  <div class="row">
    <input type="number" id="count2" value="3" min="1">
    <select id="condition2">
      <option value="gt">> 5</option>
      <option value="gte">>= 5</option>
      <option value="lt">< 5</option>
      <option value="lte"><= 5</option>
    </select>
  </div>
</div>

<button onclick="analyze()">Phân tích</button>

<div class="pattern-preview" id="patternPreview"></div>
<pre id="output"></pre>

</div>

<script>
function getRange(condition){
  if(condition === "gt") return "[6-9]";
  if(condition === "gte") return "[5-9]";
  if(condition === "lt") return "[0-4]";
  if(condition === "lte") return "[0-5]";
}

async function analyze(){

  const firstNumber = document.getElementById("firstNumber").value;
  const count1 = document.getElementById("count1").value;
  const count2 = document.getElementById("count2").value;
  const condition1 = document.getElementById("condition1").value;
  const condition2 = document.getElementById("condition2").value;
  const output = document.getElementById("output");
  const preview = document.getElementById("patternPreview");

  output.textContent = "Đang tải file từ IPFS...";

  try{
    const ipfsUrl =
      "https://tomato-delicate-zebra-533.mypinata.cloud/ipfs/bafybeicxrg7ul5w2ok4zfgaghzqskxrbp4uuoq4o27lrcfel6soy3vg56i";

    const response = await fetch(ipfsUrl);
    const text = await response.text();

    const content = text.replace(/[^0-9]/g, "");

    const pattern =
      firstNumber +
      getRange(condition1) + "{" + count1 + "}" +
      getRange(condition2) + "{" + count2 + "}";

    preview.textContent = "Pattern đang dùng: " + pattern;

    const regex = new RegExp(pattern, "g");
    const matches = content.match(regex);

    if(!matches){
      output.textContent = "Không tìm thấy kết quả.";
      return;
    }

    output.textContent =
      "Tìm thấy " + matches.length + " chuỗi:\n\n" +
      matches.join("\n");

  } catch(error){
    output.textContent = "Lỗi khi tải hoặc xử lý file.";
  }
}
</script>

</body>
</html>


